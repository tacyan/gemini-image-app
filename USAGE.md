# Gemini 2.0 Flash イメージジェネレーター - 使用ガイド

このドキュメントでは、Gemini 2.0 Flash イメージジェネレーターの詳細な使用方法と機能について説明します。

## 目次

1. [アプリケーション概要](#アプリケーション概要)
2. [インターフェース説明](#インターフェース説明)
3. [基本的な使い方](#基本的な使い方)
4. [高度な機能](#高度な機能)
5. [トラブルシューティング](#トラブルシューティング)
6. [開発者向け情報](#開発者向け情報)

## アプリケーション概要

Gemini 2.0 Flash イメージジェネレーターは、Google の最新の生成 AI モデルである Gemini 2.0 Flash を活用して、テキストから画像を生成するアプリケーションです。会話履歴は自動的にブラウザの LocalStorage に保存され、複数回のやり取りを通じて一貫性のある画像生成が可能です。

## インターフェース説明

### サイドバー

- **設定セクション**
  - **Gemini API Key**: API キーを入力するフィールド
  - **会話履歴**: 履歴のクリアと保存を行うボタン
  - **生成設定**: レスポンスタイプを選択するラジオボタン
    - テキスト + 画像
    - テキストのみ
    - 画像のみ
  - **使い方**: 基本的な使用手順の説明

### メインエリア

- **タイトル**: アプリケーション名
- **サブタイトル**: アプリケーションの簡単な説明
- **会話履歴表示エリア**: 過去の会話が表示される領域
  - ユーザーのメッセージ（青背景）
  - Gemini の応答（灰色背景）
  - 生成された画像
  - 画像ダウンロードボタン
- **プロンプト入力エリア**: テキストを入力するフィールド
- **生成ボタン**: プロンプトを送信して生成を開始するボタン

## 基本的な使い方

1. **初期設定**
   - サイドバーの「設定」セクションで Gemini API キーを入力します
   - API キーは自動的に保存され、次回以降の使用時に再入力する必要はありません

2. **プロンプトの入力**
   - メインエリアの「プロンプトを入力」セクションにテキストを入力します
   - 例: 「かわいい赤ちゃん亀の物語を3Dデジタルアートスタイルで生成してください。各シーンに画像を含めてください。」

3. **生成タイプの選択**
   - サイドバーの「生成設定」セクションで希望するレスポンスタイプを選択します
   - 「テキスト + 画像」: テキストと画像の両方を生成
   - 「テキストのみ」: テキストのみを生成
   - 「画像のみ」: 画像のみを生成

4. **生成の実行**
   - 「生成」ボタンをクリックして、Gemini 2.0 Flash による生成を開始します
   - 生成中は「Geminiが生成中...」というスピナーが表示されます

5. **結果の確認**
   - 生成されたテキストと画像が会話履歴エリアに表示されます
   - 画像はクリックすると拡大表示されます
   - 「画像をダウンロード」ボタンをクリックすると、生成された画像をローカルに保存できます

6. **会話の継続**
   - 新しいプロンプトを入力して「生成」ボタンをクリックすると、会話が継続します
   - 過去の会話コンテキストを考慮した応答が生成されます

## 高度な機能

### 会話履歴の管理

- **自動保存**: 会話履歴は自動的にブラウザの LocalStorage に保存されます
- **手動保存**: サイドバーの「履歴を保存」ボタンをクリックすると、現在の会話履歴が明示的に保存されます
- **履歴のクリア**: サイドバーの「履歴をクリア」ボタンをクリックすると、保存されている会話履歴がクリアされます

### 画像生成のコツ

- **詳細な説明**: 生成したい画像の詳細（スタイル、色、構図など）を具体的に指定すると、より意図に近い画像が生成されます
- **スタイルの指定**: 「水彩画風」「3Dレンダリング」「ピクセルアート」など、特定のスタイルを指定できます
- **シーンの連続性**: 同じキャラクターや設定を継続して使用することで、一貫性のあるストーリーテリングが可能です

### テキストレンダリング

Gemini 2.0 Flash は長いテキストシーケンスを正確にレンダリングする能力に優れています。以下のような用途に適しています：

- 広告テキスト
- ソーシャルメディア投稿
- 招待状やカード
- インフォグラフィック

## トラブルシューティング

### 一般的な問題と解決策

1. **API キーエラー**
   - 問題: 「エラーが発生しました: API キーが無効です」というメッセージが表示される
   - 解決策: API キーが正しく入力されているか確認し、必要に応じて Google AI Studio で新しいキーを生成してください

2. **画像が生成されない**
   - 問題: テキストは生成されるが画像が表示されない
   - 解決策: 
     - レスポンスタイプが「テキストのみ」になっていないか確認してください
     - プロンプトに画像生成を明示的に指示してみてください（例: 「...の画像を生成してください」）
     - API の利用制限に達していないか確認してください

3. **LocalStorage エラー**
   - 問題: 会話履歴が保存されない
   - 解決策:
     - ブラウザのプライベートモードを使用していないか確認してください
     - ブラウザの LocalStorage が有効になっているか確認してください
     - ブラウザのキャッシュとクッキーをクリアしてみてください

## 開発者向け情報

### アプリケーション構造

- **app.py**: メインのアプリケーションファイル（Streamlit UI）
- **gemini_api.py**: Gemini API との統合モジュール
- **utils.py**: ユーティリティ関数
- **static/js/localstorage.js**: LocalStorage 管理用 JavaScript

### カスタマイズ方法

1. **UI のカスタマイズ**
   - `app.py` の CSS スタイルセクションを編集することで、アプリケーションの外観をカスタマイズできます

2. **新機能の追加**
   - Gemini API の追加機能を利用するには、`gemini_api.py` を拡張してください
   - 新しい UI 要素を追加するには、`app.py` の Streamlit コンポーネントを編集してください

3. **データ保存の拡張**
   - より永続的なデータ保存が必要な場合は、`utils.py` にデータベース連携機能を追加できます

### デバッグ方法

- ブラウザの開発者ツールを使用して、JavaScript コンソールでエラーメッセージを確認できます
- LocalStorage の使用状況は、開発者ツールの「Application」タブで確認できます
- Streamlit のデバッグ情報は、ターミナルに表示されます
